
@namespace("keybase.1")
protocol login {

	import idl "common.avdl";

	record LoginResBody {
		UID uid;
	}

	record IsLoggedInRes {
		union { null, LoginResBody } body;
		Status status;
	}

	record IsLoggedInArg {

	}

	record PasswordLoginArg {
		string password;
	}

	record PubkeyLoginArg {

	}

	record PasswordLoginRes {
		union { null, LoginResBody } body;
		Status status;
	}

	record PubkeyLoginRes {
		union { null, LoginResBody } body;
		Status status;
	}

	record LogoutRes {
		Status status;
	}

	record LogoutArg {

	}

	record SwitchUserRes {
		Status status;
	}

	record SwitchUserArg {
		string username;
	}

	IsLoggedInRes isLoggedIn(IsLoggedInArg arg);
	PasswordLoginRes passwordLogin(PasswordLoginArg arg);
	PubkeyLoginRes pubkeyLogin(PubkeyLoginArg arg);
	LogoutRes logout(LogoutArg arg);
	SwitchUserRes switchUser(SwitchUserArg arg);
}
