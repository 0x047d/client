# Maintainer: Jack O'Connor <oconnor663@gmail.com>

pkgname=keybase
pkgdesc='LOCAL BUILD'
license=('BSD')
# KEYBASE_VERSION works around the problem that makepkg never runs the pkgver()
# function when --noextract is set. The caller must export this variable.
pkgver=$KEYBASE_VERSION
pkgrel=1
arch=('i686' 'x86_64')
depends=(fuse)
makedepends=(go npm)
source=(
  'git+ssh://git@github.com/keybase/client'
  'git+ssh://git@github.com/keybase/kbfs'
)
md5sums=('SKIP')

build() {
  client/packaging/linux/build_binaries.sh prerelease build_dir
}

package() {
  if [ "$CARCH" = x86_64 ] ; then
    debian_arch=amd64
  else
    debian_arch=i386
  fi
  cp -r "$srcdir/build_dir/binaries/$debian_arch"/* "$pkgdir"
}
